<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.community.mapper.ReplyMapper">
	
	<resultMap type="Reply" id="replyMap">
		<id property="no" column="no" />
		<result property="boardNo" column="board_no" />
		<result property="usersId" column="users_id" />
		<result property="content" column="content" />
		<result property="regDate" column="reg_date" />
		<association property="user" javaType="users">
			<result property="id" column="id" />
			<result property="nickName" column="nickName" />
		</association>
		<association property="board" javaType="board">
			<result property="no" column="no" />
			<result property="title" column="title" />
		</association>
	</resultMap>
	
	<select id="create">
		INSERT INTO Reply values(seq_reply_no.nextval, #{boardNo}, #{usersId}, #{content}, sysdate)
	</select>
	
	<select id="list" resultMap="replyMap">
		SELECT u.nickName, r.reg_date, r.no, r.content
		FROM Users u INNER JOIN
		Reply r ON u.id = r.users_id
		WHERE r.board_no = #{no}
		Order by r.reg_date asc
	</select>
	
</mapper>